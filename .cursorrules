# Cursor AI Rules for LumoFit

## üéØ Current Sprint: Door to Door Con (D2D Con) Demo

**Timeline:** ~8 days (Demo around Jan 21, 2026)
**Focus:** Polish Map + Discover tabs, simplify UI, TestFlight beta

### Sprint Priorities
1. Map Tab - Color-coded pins, quick search, distance filters
2. Discover Tab - Photo carousel, better cards
3. Saved Locations - Quick save without trips, albums
4. Simplification - Hide Challenges, Log Activity, complex features
5. TestFlight - Public link for conference attendees

---

## üìö Critical Files to Read First

1. **AGENT.md** - AI coding patterns and conventions
2. **CONTEXT.md** - Business requirements and meeting notes
3. **PLAN.md** - Sprint tasks with checkboxes
4. **knowledge.md** - Full technical documentation

---

## üèóÔ∏è Project Context

**App:** LumoFit (formerly FitTravel) - Fitness travel app

**Stack:**
- Flutter 3.6+ / Dart
- Provider for state management
- GoRouter for navigation
- Supabase (PostgreSQL, Auth, Storage, Edge Functions)
- Google Maps & Places APIs
- Gemini 2.5 Flash for AI features

---

## ‚úÖ Do's

- [ ] Read PLAN.md before starting any task
- [ ] Use Provider pattern (not Riverpod)
- [ ] Use GoRouter for navigation (not Navigator)
- [ ] Use `withValues()` instead of `withOpacity()`
- [ ] Follow existing code patterns in lib/services/
- [ ] Test on iOS before committing
- [ ] Update PLAN.md checkbox when task complete

---

## üö´ Don'ts

- [ ] Don't add new features (focus on polish)
- [ ] Don't refactor architecture
- [ ] Don't change state management approach
- [ ] Don't use `setState` for shared state
- [ ] Don't use `print()` (use Logger)
- [ ] Don't hardcode API keys
- [ ] Don't modify Supabase schema

---

## üé® Code Patterns

### State Management
```dart
// Services extend ChangeNotifier
class PlaceService extends ChangeNotifier {
  List<Place> _places = [];
  bool _isLoading = false;

  // Expose via getters
  List<Place> get places => _places;
  bool get isLoading => _isLoading;

  // Notify on changes
  Future<void> load() async {
    _isLoading = true;
    notifyListeners();
    // ...
  }
}
```

### Navigation
```dart
// Use GoRouter
context.go('/discover');            // Replace
context.push('/place/${place.id}'); // Push
```

### Theme Colors
```dart
// Use theme, not hardcoded
Theme.of(context).colorScheme.primary
Colors.white.withValues(alpha: 0.5) // NOT withOpacity
```

---

## üìÇ Key Files

| Purpose | File |
|---------|------|
| Entry point | `lib/main.dart` |
| Routes | `lib/nav.dart` |
| Theme | `lib/theme.dart` |
| Supabase | `lib/supabase/supabase_config.dart` |
| Map screen | `lib/screens/map/map_screen.dart` |
| Discover | `lib/screens/discover/discover_screen.dart` |

---

## üîß Sprint-Specific Tasks

### Map Tab (Priority 1)
- `lib/screens/map/map_screen.dart`
- `lib/screens/map/widgets/map_filter_bar.dart`
- Add color-coded markers by type
- Add search bar with autocomplete
- Add distance filters

### Discover Tab (Priority 1)
- `lib/screens/discover/discover_screen.dart`
- `lib/screens/discover/place_detail_screen.dart`
- Add photo carousel to cards
- Improve visual hierarchy

### Simplification (Priority 2)
- `lib/screens/main_shell.dart`
- `lib/screens/home/home_screen.dart`
- Hide Challenges, Log Activity
- Consider 4-tab layout

---

## ‚ö†Ô∏è AI Model Note

This project uses **Gemini 2.5 Flash** via Supabase Edge Functions.
- Model ID: `gemini-2.5-flash`
- Edge Functions: `supabase/functions/`
- Do NOT change AI models without explicit approval

---

## üìû Communication

- **Slack** - Primary async channel
- **GitHub** - Code and issues
- **PLAN.md** - Track progress with checkboxes
